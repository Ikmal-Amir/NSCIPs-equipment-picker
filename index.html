<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Equipment Search</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    input {
      padding: 8px;
      width: 300px;
      margin-bottom: 10px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
    }
    th {
      background-color: #009688;
      color: white;
    }
  </style>
</head>
<body>
  <h2>Equipment List Search</h2>
  <input type="text" id="searchInput" placeholder="Search equipment number or name...">
  
  <table id="equipmentTable">
    <thead>
      <tr>
        <th>Equipment Number</th>
        <th>Equipment Name</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    let allRows = []; // Full dataset
    let allRowsLower = []; // Lowercase version for search
    let searchTimeout;

    // Load CSV from GitHub
    function loadCSV() {
      fetch('https://github.com/Ikmal-Amir/NSCIPs-equipment-picker/blob/86a45ff85e1798a00a504a8c1b824418db191928/equipment.csv')
        .then(res => res.text())
        .then(text => {
          allRows = text.trim().split('\n').map(r => r.split(','));
          allRowsLower = allRows.map(r => r.map(c => c.toLowerCase()));
          renderTable(allRows); // Show full table on load
        });
    }

    // Render table rows
    function renderTable(rows) {
      const tbody = document.querySelector('#equipmentTable tbody');
      tbody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        row.forEach(cell => {
          const td = document.createElement('td');
          td.textContent = cell;
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
    }

    // Filter table
    function filterTable(searchValue) {
      if (!searchValue) {
        renderTable(allRows);
        return;
      }
      searchValue = searchValue.toLowerCase();
      const filtered = allRowsLower
        .map((row, idx) => row.some(cell => cell.includes(searchValue)) ? allRows[idx] : null)
        .filter(Boolean);
      renderTable(filtered);
    }

    // Debounced search
    document.getElementById('searchInput').addEventListener('input', function () {
      clearTimeout(searchTimeout);
      searchTimeout = setTimeout(() => {
        filterTable(this.value);
      }, 300);
    });

    loadCSV();
  </script>
</body>
</html>


